# Baby, It’s CeWLd Outside
## Scenario

The team detects a malicious actor using an employee account to access an internal messaging portal. Help McSkidy figure out how they might have gained the correct credentials
## Learning Objectives

    What is CeWL?
    What are the capabilities of CeWL?
    How can we leverage CeWL to generate a custom wordlist from a website?
    How can we customise the tool’s output for specific tasks?

## Overview

    CeWL (pronounced “cool”) is a custom word list generator tool that spiders websites to create word lists based on the site’s content.
    Spidering, in the context of web security and penetration testing, refers to the process of automatically navigating and cataloguing a website’s content, often to retrieve the site structure, content, and other relevant details.
    This capability makes CeWL especially valuable to penetration testers aiming to brute-force login pages or uncover hidden directories using organisation-specific terminology.
    Beyond simple wordlist generation, CeWL can also compile a list of email addresses or usernames identified in team members’ page links.
    Such data can then serve as potential usernames in brute-force operations.

First we use the AntarctiCrafts homepage to generate a wordlist that could potentially hold the key to the portal.
we thus use the command `cewl -d 2 -m 5 -w pswd.txt http://10.10.138.243 --with-numbers`

This spiders two links deep and lists words with minimum 5 letters. The --with-numbers option will append numbers to words.

Now we must make another file for the usernames.

Thus we use the following command `cewl -d 0 -m 5 -w usrnms.txt http://10.10.138.243/team.php --lowercase`

These files must be tried in the login.php site so we can find the correct pair, This can be done by a command tool called Wfuzz.

The command we use is `wfuzz -c -z file,usrnms.txt -z file,pswd.txt --hs "Please enter the correct credentials" -u http://10.10.138.243/login.php -d "username=FUZZ&password=FUZ2Z"`

    -z file,usrnms.txt loads the usernames list.

    -z file,pswd.txt uses the password list generated by CeWL.

    --hs "Please enter the correct credentials" hides responses containing the string "Please enter the correct credentials", which is the message displayed for wrong login attempts.

    -u specifies the target URL.

    -d "username=FUZZ&password=FUZ2Z" provides the POST data format where FUZZ will be replaced by usernames and FUZ2Z by passwords.

We get the output as
![image](https://github.com/pixie-nukes/JTP23-WriteUps/assets/94845416/47cb6bdb-4dd6-48e0-b634-435e1309a271)
Now we enter these credentials and retrieve the flag 
![image](https://github.com/pixie-nukes/JTP23-WriteUps/assets/94845416/c4216722-1963-4036-b799-da1d5b99fa5e)


### 1. What is the correct username and password combination? Format username: password
Ans: isaias:Happiness

### 2. What is the Flag?
Ans: THM{m3rrY4nt4rct1crAft$}
