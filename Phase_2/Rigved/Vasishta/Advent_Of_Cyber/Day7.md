# Tis the season for log chopping! 
## Scenario:

A lot of unusual traffic is detected again. A large bandwidth of data was being sent outside the network. Given this, the security team start to analyze the proxy log

## Log Primer
Before analysing a dataset of proxy logs, let’s first revisit what log files are.
A log file is like a digital trail of what’s happening behind the scenes in a computer or software application. It records important events, actions, errors, or information as they happen. It helps diagnose problems, monitor performance, and record what a program or application is doing.
![image](https://github.com/pixie-nukes/AdventOfCyber2023/assets/94845416/825bcb15-b729-4b17-96d9-367bc650e66e)

## What Is a Proxy Server

Since the data to be analysed is a proxy log, we must understand a proxy server.

  1. A proxy server is an intermediary between your computer or device and the internet. When you request information or access a web page, your device connects to the proxy server instead of connecting directly to the target server. The proxy server then forwards your request to the internet, receives the response, and sends it back to your device.
  2. A proxy server offers enhanced visibility into network traffic and user activities, since it logs all web requests and responses. This enables system administrators and security analysts to monitor which websites users access, when, and how much bandwidth is used. It also allows administrators to enforce policies and block specific websites or content categories.

![image](https://github.com/pixie-nukes/AdventOfCyber2023/assets/94845416/bfa59b6b-bd10-4dcd-b8d8-4f0a7a0cabb8)

## Tasks:
### 1. How many unique IP addresses are connected to the proxy server?
Using the below command I got to know the answer
> cut -d ‘ ‘ -f2 access.log | sort | uniq -c | sort -n | wc -l
> 
ANS: 9

### 2. How many unique domains were accessed by all workstations?
> cut -d ‘ ‘ -f3 access.log | cut -d ‘:’ -f1 | sort | uniq -c | sort -n | wc -l
> 
ANS: 111
### 3. What status code is generated by the HTTP requests to the least accessed domain?
I searched the domain which is least accessed by the command below
>  cut -d ‘ ‘ -f3 access.log | cut -d ‘:’ -f1 | sort | uniq -c | sort -n
> 
ANS: 503
### 4. Based on the high count of connection attempts, what is the name of the suspicious domain?
I found that the below domain has thm as top level domain.
> ANS:  frostlings.bigbadstash.thm
### 5. What is the source IP of the workstation that accessed the malicious domain?
> cut -d ‘ ‘ -f2,3 access.log | cut -d ‘:’ -f1 | sort | uniq -c | sort -n | tail -1
> 
ANS:  10.10.185.225
### 6. How many requests were made on the malicious domain in total?
I can find that in the previous command.
>ANS: 1581
### 7. Having retrieved the exfiltrated data, what is the hidden flag?
Using the below command I found the flag
> grep frostlings.bigbadstash.thm access.log | cut -d ‘ ‘ -f5 | cut -d ‘=’ -f2 | base64 -d
> 
ANS: THM{a_gift_for_you_awesome_analyst!}
